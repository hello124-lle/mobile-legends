<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Round Worm</title>
  <script type="application/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/processing.js/1.4.8/processing.min.js"></script>
</head>
<body>

  <canvas id="wormCanvas"></canvas>

  <script type="application/processing">
    float heading;
    float x;
    float y;
    float speed = 1;
    float thickness = 10;  // Adjusted to make the worm segments larger

    float r = 128;
    float g = 128;
    float b = 128;

    float prevLeftX;
    float prevLeftY;
    float prevRightX;
    float prevRightY;

    void setup() {
      size(500, 500);
      noSmooth();
      frameRate(500);
      background(64);
    }

    void draw() {
      heading += sin(radians(frameCount)) * 3 + randomGaussian() * 4;

      r += random(-10, 10);
      g += random(-10, 10);
      b = constrain(b, 0, 256);

      r = constrain(r, 0, 256);
      g = constrain(g, 0, 256);
      b += random(-10, 10);

      x += cos(radians(heading)) * speed;
      y += sin(radians(heading)) * speed;

      if (x < 0) {
        x = width;
        prevLeftX += width;
        prevRightX += width;
      }
      if (x > width) {
        x = 0;
        prevLeftX -= width;
        prevRightX -= width;
      }

      if (y < 0) {
        y = height;
        prevLeftY += height;
        prevRightY += height;
      }
      if (y > height) {
        y = 0;
        prevLeftY -= height;
        prevRightY -= height;
      }

      float leftX = x + cos(radians(heading - 90)) * thickness;
      float leftY = y + sin(radians(heading - 90)) * thickness;

      float rightX = x + cos(radians(heading + 90)) * thickness;
      float rightY = y + sin(radians(heading + 90)) * thickness;

      noStroke();
      fill(r, g, b);

      // Draw the worm as a series of circles
      float lerpFactor = 0.1; // A factor to smooth the transition between segments
      float segmentRadius = thickness / 2;

      // Draw a circle at the previous position (tail)
      ellipse(prevLeftX, prevLeftY, segmentRadius * 2, segmentRadius * 2);
      ellipse(prevRightX, prevRightY, segmentRadius * 2, segmentRadius * 2);

      // Draw a circle at the current position (head)
      ellipse(leftX, leftY, segmentRadius * 2, segmentRadius * 2);
      ellipse(rightX, rightY, segmentRadius * 2, segmentRadius * 2);

      prevLeftX = leftX;
      prevLeftY = leftY;
      prevRightX = rightX;
      prevRightY = rightY;
    }
  </script>

</body>
</html>
